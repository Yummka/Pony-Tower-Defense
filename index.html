<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ó–∞—â–∏—Ç–∞ –ë–∞—à–Ω–∏ (Tower Defense)</title>
    
    <!-- –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –≤–Ω–µ—à–Ω–µ–≥–æ —Ñ–∞–π–ª–∞ —Å—Ç–∏–ª–µ–π -->
    <link rel="stylesheet" href="Css.css">
    
    <!-- –ò–º–ø–æ—Ä—Ç —à—Ä–∏—Ñ—Ç–∞, –∫–æ—Ç–æ—Ä—ã–π —Ç–µ–ø–µ—Ä—å –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ CSS -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
    
    <script>
        // –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Tailwind –æ—Å—Ç–∞–µ—Ç—Å—è –∑–¥–µ—Å—å, —Ç–∞–∫ –∫–∞–∫ –æ–Ω–∞ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –¥–æ –∑–∞–≥—Ä—É–∑–∫–∏ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ —Å–∫—Ä–∏–ø—Ç–∞
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Press Start 2P', 'cursive'], 
                    },
                    colors: {
                        'primary': '#4f46e5',
                        'secondary': '#3c3c58',
                        'money': '#10b981',
                        'lives': '#ef4444',
                        'wave': '#3b82f6',
                    }
                }
            }
        }
    </script>
</head>
<body>

    <!-- –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é -->
    <div id="mainMenu" class="absolute inset-0 bg-secondary/95 backdrop-blur-sm flex flex-col items-center justify-center p-8 z-50">
        <h1 class="text-4xl font-extrabold text-white mb-8">–ú–∞–π –õ–∏—Ç–ª –¢–∞—É—ç—Ä –î–µ—Ñ–µ–Ω—Å</h1>
        <div id="levelSelection" class="space-y-4 w-full max-w-sm"></div>
    <p class="text-sm text-gray-400 mt-10">–ó–∞—â–∏—Ç–∏ –≠–∫–≤–µ—Å—Ç—Ä–∏—é!</p>
    </div>

    <!-- –≠–∫—Ä–∞–Ω –∫–æ–Ω—Ü–∞ –∏–≥—Ä—ã (—Å—Ç–∞—Ä—ã–π) -->
    <div id="endScreen" class="absolute inset-0 bg-black/95 backdrop-blur-sm flex flex-col items-center justify-center p-8 z-50 hidden">
        <h1 id="endMessage" class="text-4xl font-extrabold text-white mb-4"></h1>
        <p id="endStats" class="text-lg text-gray-300 mb-8"></p>
        <button id="returnToMenuButton" class="px-6 py-3 bg-primary hover:bg-indigo-700 text-white font-semibold rounded-lg shadow-lg transition duration-300">
            –í–µ—Ä–Ω—É—Ç—å—Å—è –≤ –º–µ–Ω—é
        </button>
    </div>

    <!-- –í—Å–ø–ª—ã–≤–∞—é—â–µ–µ –æ–∫–Ω–æ –ø–æ–±–µ–¥—ã -->
    <div id="win-popup" class="hidden fixed inset-0 flex items-center justify-center bg-black bg-opacity-70 z-50 p-4">
        <div class="bg-secondary border-2 border-money/50 rounded-xl p-8 text-center text-white max-w-lg w-full shadow-2xl">
            <h2 class="text-3xl font-bold text-money mb-4">–£–†–û–í–ï–ù–¨ –ü–†–û–ô–î–ï–ù!</h2>
            <p class="text-gray-300 mb-6">–û—Ç–ª–∏—á–Ω–∞—è —Ä–∞–±–æ—Ç–∞! –í—Ä–∞–≥–∏ –ø–æ–≤–µ—Ä–∂–µ–Ω—ã.</p>
            <div class="flex justify-center gap-4 text-lg mb-8">
                <p>üí∞ –ó–æ–ª–æ—Ç–æ: <span id="win-money-stat" class="font-bold text-yellow-300">0</span></p>
                <p>‚ù§Ô∏è –ñ–∏–∑–Ω–∏: <span id="win-lives-stat" class="font-bold text-red-400">0</span></p>
            </div>
            <div class="flex flex-col sm:flex-row gap-4 justify-center">
                <button id="next-level-button" class="px-6 py-3 bg-money hover:bg-green-700 font-semibold rounded-lg shadow-lg transition duration-300 w-full sm:w-auto">–°–ª–µ–¥—É—é—â–∏–π —É—Ä–æ–≤–µ–Ω—å</button>
                <button id="main-menu-button" class="px-6 py-3 bg-primary hover:bg-indigo-700 font-semibold rounded-lg shadow-lg transition duration-300 w-full sm:w-auto">–ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é</button>
                
            </div>
        </div>
    </div>

    <!-- –í—Å–ø–ª—ã–≤–∞—é—â–µ–µ –æ–∫–Ω–æ –ø–æ—Ä–∞–∂–µ–Ω–∏—è -->
    <div id="lose-popup" class="hidden fixed inset-0 flex items-center justify-center bg-black bg-opacity-70 z-50 p-4">
        <div class="bg-secondary border-2 border-lives/50 rounded-xl p-8 text-center text-white max-w-lg w-full shadow-2xl">
            <h2 class="text-3xl font-bold text-lives mb-4">–ü–û–†–ê–ñ–ï–ù–ò–ï...</h2>
            <p class="text-gray-300 mb-8">–í—Ä–∞–≥–∏ –ø—Ä–æ—Ä–≤–∞–ª–∏ –æ–±–æ—Ä–æ–Ω—É. –ü–æ–ø—Ä–æ–±—É–π –µ—â–µ —Ä–∞–∑!</p>
            <div class="flex flex-col sm:flex-row gap-4 justify-center">
                <button id="restart-button" class="px-6 py-3 bg-primary hover:bg-indigo-700 font-semibold rounded-lg shadow-lg transition duration-300 w-full sm:w-auto">–ù–∞—á–∞—Ç—å –∑–∞–Ω–æ–≤–æ</button>
                <!-- –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ: –ö–Ω–æ–ø–∫–∞ –≤–æ–∑–≤—Ä–∞—Ç–∞ –≤ –º–µ–Ω—é —É–∂–µ –µ—Å—Ç—å –≤ `win-popup`, –Ω–æ –Ω—É–∂–Ω–∞ –∏ –∑–¥–µ—Å—å. JS –Ω–∞–π–¥–µ—Ç –µ–µ –ø–æ ID `returnToMenuButton` –∏–∑ —Å—Ç–∞—Ä–æ–≥–æ `endScreen`. –ú–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–æ—Ç –∂–µ ID –∏–ª–∏ –¥–æ–±–∞–≤–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è –Ω–æ–≤–æ–≥–æ. –î–∞–≤–∞–π—Ç–µ –∏—Å–ø–æ–ª—å–∑—É–µ–º —Å—Ç–∞—Ä—ã–π –¥–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏ -->
                <button id="returnToMenuButton" class="px-6 py-3 bg-gray-600 hover:bg-gray-700 font-semibold rounded-lg shadow-lg transition duration-300 w-full sm:w-auto">–ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é</button>
            </div>
        </div>
    </div>

    <!-- –í—Å–ø–ª—ã–≤–∞—é—â–µ–µ –æ–∫–Ω–æ –∏–Ω—Ç—Ä–æ –§–ª–∞—Ç—Ç–µ—Ä—à–∞–π -->
    <div id="fluttershyIntroPopup" class="hidden fixed inset-0 flex items-center justify-center bg-black bg-opacity-70 z-50 p-4">
        <div class="bg-secondary border-2 border-yellow-300/50 rounded-xl p-8 text-center text-white max-w-2xl w-full shadow-2xl flex flex-col md:flex-row items-center gap-8">
            <img src="images/–§–ª–∞—Ç_—Å—Ç–æ–∏—Ç.png" alt="Fluttershy" class="w-32 h-32 object-contain">
            <div>
                <h2 class="text-2xl font-bold text-yellow-300 mb-4">–ù–û–í–ê–Ø –ü–û–ù–ò –î–û–°–¢–£–ü–ù–ê!</h2>
                <p class="text-left text-gray-300 mb-6">
                    –≠—Ç–æ <b>–§–ª–∞—Ç—Ç–µ—Ä—à–∞–π</b>! –û–Ω–∞ –Ω–µ –Ω–∞–Ω–æ—Å–∏—Ç —É—Ä–æ–Ω–∞, –Ω–æ –µ—ë –¥–æ–±—Ä—ã–π –≤–∑–≥–ª—è–¥ <b>–∑–∞–º–µ–¥–ª—è–µ—Ç</b> –≤—Å–µ—Ö –≤—Ä–∞–≥–æ–≤ –≤ –±–æ–ª—å—à–æ–º —Ä–∞–¥–∏—É—Å–µ.
                    –ò—Å–ø–æ–ª—å–∑—É–π –µ—ë, —á—Ç–æ–±—ã –¥–∞—Ç—å –¥—Ä—É–≥–∏–º –ø–æ–Ω–∏ –±–æ–ª—å—à–µ –≤—Ä–µ–º–µ–Ω–∏ –Ω–∞ –∞—Ç–∞–∫—É!
                </p>
                <button id="startLevelAfterIntroButton" class="w-full px-6 py-3 bg-yellow-500 hover:bg-yellow-600 text-secondary-900 font-semibold rounded-lg shadow-lg transition duration-300">
                    –ù–∞—á–∞—Ç—å —É—Ä–æ–≤–µ–Ω—å!
                </button>
            </div>
        </div>
    </div>

    <div id="rainbowDashIntroPopup" class="hidden fixed inset-0 flex items-center justify-center bg-black bg-opacity-70 z-50 p-4">
    <div class="bg-secondary border-2 border-cyan-400/50 rounded-xl p-8 text-center text-white max-w-2xl w-full shadow-2xl flex flex-col md:flex-row items-center gap-8">
        <img src="images/–†–∞–¥—É–≥–∞–°—Ç–æ–∏—Ç.png" alt="Rainbow Dash" class="w-32 h-32 object-contain">
        <div>
            <h2 class="text-2xl font-bold text-cyan-400 mb-4">–ù–û–í–ê–Ø –ü–û–ù–ò –î–û–°–¢–£–ü–ù–ê!</h2>
            <p class="text-left text-gray-300 mb-6">
                –≠—Ç–æ <b>–†–∞–¥—É–≥–∞ –î—ç—à</b>! –û–Ω–∞ –Ω–µ —Å—Ç–æ–∏—Ç –Ω–∞ –º–µ—Å—Ç–µ. –°–Ω–∞—á–∞–ª–∞ –≤—ã–±–µ—Ä–∏—Ç–µ, –≥–¥–µ –±—É–¥–µ—Ç –µ—ë –±–∞–∑–∞, –∞ –∑–∞—Ç–µ–º ‚Äî –∫—É–¥–∞ –æ–Ω–∞ –±—É–¥–µ—Ç –ª–µ—Ç–∞—Ç—å!
                –ü—Ä–æ–ª–µ—Ç–∞—è, –æ–Ω–∞ –æ—Å—Ç–∞–≤–ª—è–µ—Ç –∑–∞ —Å–æ–±–æ–π <b>–≥—Ä–æ–∑–æ–≤–æ–π —Å–ª–µ–¥</b>, –∫–æ—Ç–æ—Ä—ã–π –Ω–∞–Ω–æ—Å–∏—Ç —É—Ä–æ–Ω –≤—Å–µ–º –≤—Ä–∞–≥–∞–º –Ω–∞ –ø—É—Ç–∏.
            </p>
            <button id="startLevelAfterRDIntroButton" class="w-full px-6 py-3 bg-cyan-500 hover:bg-cyan-600 text-white font-semibold rounded-lg shadow-lg transition duration-300">
                –ù–∞—á–∞—Ç—å —É—Ä–æ–≤–µ–Ω—å!
            </button>
        </div>
    </div>
</div>

<div id="rarityIntroPopup" class="hidden fixed inset-0 flex items-center justify-center bg-black bg-opacity-70 z-50 p-4">
    <div class="bg-secondary border-2 border-purple-400/50 rounded-xl p-8 text-center text-white max-w-2xl w-full shadow-2xl flex flex-col md:flex-row items-center gap-8">
        <img src="images/–†–∞—Ä–∏—Ç–∏–°—Ç–æ–∏—Ç.png" alt="Rarity" class="w-32 h-32 object-contain">
        <div>
            <h2 class="text-2xl font-bold text-purple-400 mb-4">–ù–û–í–ê–Ø –ü–û–ù–ò –î–û–°–¢–£–ü–ù–ê!</h2>
            <p class="text-left text-gray-300 mb-6">
                –≠—Ç–æ <b>–†—ç—Ä–∏—Ç–∏</b>! –û–Ω–∞ ‚Äî –¥–∏–≤–∞ —Å –æ–≥—Ä–æ–º–Ω—ã–º —Ä–∞–¥–∏—É—Å–æ–º –∏ —É—Ä–æ–Ω–æ–º, –Ω–æ —Å—Ç—Ä–µ–ª—è–µ—Ç —Ä–µ–¥–∫–æ. –ö–æ–≥–¥–∞ –≤—Ä–∞–≥–∏ –ø–æ–¥—Ö–æ–¥—è—Ç —Å–ª–∏—à–∫–æ–º –±–ª–∏–∑–∫–æ, –µ—ë <b>—à–∫–∞–ª–∞ –¥—Ä–∞–º—ã</b> –∑–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è.
                –ü–æ–ª–Ω–∞—è —à–∫–∞–ª–∞ –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ "–ò—Å—Ç–µ—Ä–∏–∫–µ", –∫–æ—Ç–æ—Ä–∞—è <b>–æ–≥–ª—É—à–∞–µ—Ç</b> –≤—Å–µ—Ö –≤—Ä–∞–≥–æ–≤ –≤–æ–∫—Ä—É–≥!
            </p>
            <button id="startLevelAfterRarityIntroButton" class="w-full px-6 py-3 bg-purple-500 hover:bg-purple-600 text-white font-semibold rounded-lg shadow-lg transition duration-300">
                –ù–∞—á–∞—Ç—å —É—Ä–æ–≤–µ–Ω—å!
            </button>
        </div>
    </div>
</div>

<!-- –í—Å–ø–ª—ã–≤–∞—é—â–µ–µ –æ–∫–Ω–æ —Å—é–∂–µ—Ç–∞ (–¥–ª—è —Å–º–µ–Ω—ã –≤—Ä–µ–º–µ–Ω–∏ —Å—É—Ç–æ–∫) -->
    <div id="storyPopup" class="hidden fixed inset-0 flex items-center justify-center bg-black bg-opacity-80 z-50 p-4">
        <div class="bg-secondary border-2 border-white/50 rounded-xl p-8 text-center text-white max-w-lg w-full shadow-2xl">
            <h2 id="storyTitle" class="text-3xl font-bold text-yellow-300 mb-6">–í–ù–ò–ú–ê–ù–ò–ï</h2>
            <p id="storyText" class="text-lg text-gray-200 mb-8 leading-relaxed">
                <!-- –¢–µ–∫—Å—Ç –±—É–¥–µ—Ç –º–µ–Ω—è—Ç—å—Å—è —á–µ—Ä–µ–∑ JS -->
            </p>
            <button id="closeStoryPopupButton" class="px-8 py-3 bg-primary hover:bg-indigo-600 text-white font-bold rounded-lg shadow-lg transition duration-300 text-lg">
                –ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å
            </button>
        </div>
    </div>

<!-- –í—Å–ø–ª—ã–≤–∞—é—â–µ–µ –æ–∫–Ω–æ —Å—é–∂–µ—Ç–∞ (–¥–ª—è —Å–º–µ–Ω—ã –≤—Ä–µ–º–µ–Ω–∏ —Å—É—Ç–æ–∫) -->
<div id="story-popup" class="hidden fixed inset-0 flex items-center justify-center bg-black bg-opacity-80 z-50 p-4">
    <div class="bg-secondary border-2 border-white/50 rounded-xl p-8 text-center text-white max-w-lg w-full shadow-2xl">
        <h2 id="story-title" class="text-3xl font-bold text-yellow-300 mb-6">–ó–ê–ì–û–õ–û–í–û–ö</h2>
        <p id="story-text" class="text-lg text-gray-200 mb-8 leading-relaxed">
            –¢–µ–∫—Å—Ç –∏—Å—Ç–æ—Ä–∏–∏...
        </p>
        <button id="story-next-btn" class="px-8 py-3 bg-primary hover:bg-indigo-600 text-white font-bold rounded-lg shadow-lg transition duration-300 text-lg">
            –ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å
        </button>
    </div>
</div>

    <!-- –û—Å–Ω–æ–≤–Ω–æ–π –∏–≥—Ä–æ–≤–æ–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä -->
    <!-- ‚úÖ –ù–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –∏–≥—Ä–æ–≤–æ–≥–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ -->
<div class="game-container">
    <!-- –ò–≥—Ä–æ–≤–æ–µ –ø–æ–ª–µ -->
    <canvas id="gameCanvas"></canvas>

    <!-- –ü–ê–ù–ï–õ–¨ –ò–ù–§–û–†–ú–ê–¶–ò–ò (–°–ª–µ–≤–∞) -->
    <div id="info-panel">
        <div class="stat">üí∞ –ó–æ–ª–æ—Ç–æ: <span id="moneyDisplay">100</span></div>
        <div class="stat">‚ù§Ô∏è –ñ–∏–∑–Ω–∏: <span id="livesDisplay">20</span></div>
        <div class="stat">üåä –í–æ–ª–Ω–∞: <span id="waveDisplay">1</span></div>
        <button id="startWaveButton" class="action-btn">üöÄ –ù–æ–≤–∞—è –í–æ–ª–Ω–∞</button>
        <button id="ingameMenuButton" class="action-btn secondary">üè† –í –ú–µ–Ω—é</button>
        <button id="sellTowerButton" class="action-btn secondary">üí≤ –ü—Ä–æ–¥–∞—Ç—å –ü–æ–Ω–∏</button>
    </div>

    <!-- –ü–ê–ù–ï–õ–¨ –°–¢–†–û–ò–¢–ï–õ–¨–°–¢–í–ê (–°–Ω–∏–∑—É) -->
    <div id="towers-panel">
         <!-- –°—Ç–∞—Ç—É—Å —Ä–µ–∂–∏–º–∞ —Å—Ç—Ä–æ–∏—Ç–µ–ª—å—Å—Ç–≤–∞ -->
        <div id="buildModeStatus" class="hidden">
            –†–µ–∂–∏–º —Å—Ç—Ä–æ–∏—Ç–µ–ª—å—Å—Ç–≤–∞: <b id="selectedTowerName"></b> (Esc ‚Äî –æ—Ç–º–µ–Ω–∏—Ç—å)
        </div>
        <!-- –ö–Ω–æ–ø–∫–∏ –ø–æ–∫—É–ø–∫–∏ -->
        <div class="tower-buttons-group">
            <button class="buy-btn tower-select-button" data-tower-type="–ü–∏–Ω–∫–∏ –ü–∞–π" data-cost="50">–ü–∏–Ω–∫–∏ –ü–∞–π (45üí∞)</button>
            <button class="buy-btn tower-select-button" data-tower-type="–≠–ø–ø–ª –î–∂–µ–∫" data-cost="60">–≠–ø–ø–ª –î–∂–µ–∫ (65üí∞)</button>
            <button class="buy-btn tower-select-button" data-tower-type="–¢–≤–∞–π–ª–∞–π—Ç –°–ø–∞—Ä–∫–ª" data-cost="60">–¢–≤–∞–π–ª–∞–π—Ç –°–ø–∞—Ä–∫–ª (60üí∞)</button>
            <button class="buy-btn tower-select-button" data-tower-type="–§–ª–∞—Ç—Ç–µ—Ä—à–∞–π" data-cost="55" id="fluttershy-buy-button">–§–ª–∞—Ç—Ç–µ—Ä—à–∞–π (55üí∞)</button>
            <button class="buy-btn tower-select-button" data-tower-type="–†–∞–¥—É–≥–∞ –î—ç—à" data-cost="80" id="rainbowdash-buy-button" style="display: none;">–†–∞–¥—É–≥–∞ –î—ç—à (80üí∞)</button>
            <button class="buy-btn tower-select-button" data-tower-type="–†—ç—Ä–∏—Ç–∏" data-cost="75" id="rarity-buy-button" style="display: none;">–†—ç—Ä–∏—Ç–∏ (75üí∞)</button>
        </div>

        <div id="tower-info-panel" class="hidden">
    <div class="info-header">
        <img id="info-tower-img" src="" alt="Tower Image">
        <h3 id="info-tower-name"></h3>
    </div>
    <div class="info-stats">
        <p>üí• –£—Ä–æ–Ω: <span id="info-tower-damage"></span></p>
        <p>üéØ –†–∞–¥–∏—É—Å: <span id="info-tower-range"></span></p>
        <p>‚è±Ô∏è –°–∫–æ—Ä–æ—Å—Ç—å: <span id="info-tower-speed"></span></p>
    </div>
    <p class="info-special"><b>–§–∏—à–∫–∞:</b> <span id="info-tower-special"></span></p>
</div>
    </div>
</div>



    <!-- –ü–æ–¥–∫–ª—é—á–∞–µ–º –Ω–∞—à –æ—Å–Ω–æ–≤–Ω–æ–π —Å–∫—Ä–∏–ø—Ç –≤ —Å–∞–º–æ–º –∫–æ–Ω—Ü–µ -->
    <script type="module" src="js/main.js"></script>
</body>
</html>```

